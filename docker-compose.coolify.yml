version: "3.9"

services:
  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile
    environment:
      SUPABASE_URL: ${SUPABASE_URL}
      SUPABASE_KEY: ${SUPABASE_KEY}
      JWT_SECRET: ${JWT_SECRET}
      CORS_ORIGINS: ${CORS_ORIGINS}
      ENVIRONMENT: ${ENVIRONMENT:-production}
      OPENROUTER_API_KEY: ${OPENROUTER_API_KEY:-}
      OPENAI_API_KEY: ${OPENAI_API_KEY:-}
      GOOGLE_API_KEY: ${GOOGLE_API_KEY:-}
      ANTHROPIC_API_KEY: ${ANTHROPIC_API_KEY:-}
      XAI_API_KEY: ${XAI_API_KEY:-}
      MISTRAL_API_KEY: ${MISTRAL_API_KEY:-}
      DEFAULT_MODEL: ${DEFAULT_MODEL:-google/gemini-3-pro-preview}
      DEFAULT_TEMPERATURE: ${DEFAULT_TEMPERATURE:-0.7}
    ports:
      - "8001:8001"

  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
      args:
        VITE_API_BASE: ${VITE_API_BASE}
    ports:
      - "8080:80"
    depends_on:
      - backend
